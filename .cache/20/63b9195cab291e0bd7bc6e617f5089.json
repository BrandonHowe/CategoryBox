{"id":"../node_modules/@thi.ng/rstream/subs/post-worker.js","dependencies":[{"name":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\package.json","includedInParent":true,"mtime":1602941589745},{"name":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\rstream\\package.json","includedInParent":true,"mtime":1602879073986},{"name":"@thi.ng/checks","loc":{"line":1,"column":45},"parent":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\rstream\\subs\\post-worker.js","resolved":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\checks\\index.js"},{"name":"../api","loc":{"line":2,"column":23},"parent":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\rstream\\subs\\post-worker.js","resolved":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\rstream\\api.js"},{"name":"../utils/worker","loc":{"line":3,"column":27},"parent":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\rstream\\subs\\post-worker.js","resolved":"C:\\Users\\Brandon 2\\Documents\\Projects\\categorytheory\\node_modules\\@thi.ng\\rstream\\utils\\worker.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.postWorker = void 0;\n\nvar _checks = require(\"@thi.ng/checks\");\n\nvar _api = require(\"../api\");\n\nvar _worker2 = require(\"../utils/worker\");\n\n/**\n * Creates a {@link ISubscriber | subscriber} which forwards received\n * values to given worker.\n *\n * @remarks\n * The `worker` can be an existing `Worker` instance, a JS source code\n * `Blob` or an URL string. In the latter two cases, a worker is created\n * automatically. If `transfer` is true, the received values will be\n * marked as *transferrable* and the host app loses all access\n * permissions to these marked values. See `Worker.postMessage()` for\n * details.\n *\n * If `terminate` is set to a positive number, then the worker will be\n * automatically terminated after the stated number of milliseconds\n * since the parent subscription is {@link ISubscriber.done}.\n *\n * @example\n * ```ts\n * // worker source code\n * src = `self.onmessage = (e) => console.log(\"worker\", e.data);`;\n *\n * a = stream();\n * a.subscribe(\n *   postWorker(src, { type: \"application/javascript\" }))\n * );\n *\n * a.next(42)\n * // worker 42\n * ```\n *\n * @param worker -\n * @param transfer -\n * @param terminate - worker termination delay (ms)\n */\nconst postWorker = (worker, transfer = false, terminate = 0) => {\n  const _worker = (0, _worker2.makeWorker)(worker);\n\n  return {\n    next(x) {\n      if (x instanceof Promise) {\n        x.then(y => this.next(y));\n        return;\n      }\n\n      let tx;\n\n      if (transfer) {\n        const ta = (0, _checks.isTypedArray)(x);\n\n        if (ta || (0, _checks.isTransferable)(x)) {\n          tx = [ta ? x.buffer : x];\n        }\n      }\n\n      _worker.postMessage(x, tx || []);\n    },\n\n    done() {\n      if (terminate > 0) {\n        setTimeout(() => {\n          _api.LOGGER.info(\"terminating worker...\");\n\n          _worker.terminate();\n        }, terminate);\n      }\n    }\n\n  };\n};\n\nexports.postWorker = postWorker;"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":8,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":1,"column":0}},{"generated":{"line":10,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":2,"column":0}},{"generated":{"line":12,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":3,"column":0}},{"generated":{"line":14,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":4,"column":0}},{"generated":{"line":48,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":7}},{"name":"postWorker","generated":{"line":48,"column":6},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":13}},{"generated":{"line":48,"column":16},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":23}},{"generated":{"line":48,"column":19},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":26}},{"name":"worker","generated":{"line":48,"column":20},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":27}},{"generated":{"line":48,"column":26},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":26}},{"name":"transfer","generated":{"line":48,"column":28},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":35}},{"generated":{"line":48,"column":36},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":43}},{"generated":{"line":48,"column":39},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":46}},{"generated":{"line":48,"column":44},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":26}},{"name":"terminate","generated":{"line":48,"column":46},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":53}},{"generated":{"line":48,"column":55},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":62}},{"generated":{"line":48,"column":58},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":65}},{"generated":{"line":48,"column":59},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":26}},{"generated":{"line":48,"column":64},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":71}},{"generated":{"line":49,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":4}},{"name":"_worker","generated":{"line":49,"column":8},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":10}},{"generated":{"line":49,"column":15},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":17}},{"generated":{"line":49,"column":18},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":20}},{"name":"worker","generated":{"line":49,"column":43},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":31}},{"generated":{"line":49,"column":49},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":20}},{"generated":{"line":49,"column":50},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":39,"column":4}},{"generated":{"line":51,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":40,"column":4}},{"generated":{"line":51,"column":9},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":40,"column":11}},{"name":"next","generated":{"line":52,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":41,"column":8}},{"name":"next","generated":{"line":52,"column":4},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":41,"column":8}},{"generated":{"line":52,"column":8},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":41,"column":12}},{"name":"x","generated":{"line":52,"column":9},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":41,"column":13}},{"generated":{"line":52,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":41,"column":12}},{"generated":{"line":52,"column":12},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":41,"column":16}},{"generated":{"line":53,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":42,"column":12}},{"name":"x","generated":{"line":53,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":42,"column":16}},{"generated":{"line":53,"column":11},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":42,"column":17}},{"name":"Promise","generated":{"line":53,"column":23},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":42,"column":29}},{"generated":{"line":53,"column":30},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":42,"column":12}},{"generated":{"line":53,"column":32},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":42,"column":38}},{"name":"x","generated":{"line":54,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":16}},{"name":"x","generated":{"line":54,"column":8},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":16}},{"generated":{"line":54,"column":9},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":17}},{"name":"then","generated":{"line":54,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":18}},{"generated":{"line":54,"column":14},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":16}},{"name":"y","generated":{"line":54,"column":15},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":24}},{"generated":{"line":54,"column":16},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":23}},{"generated":{"line":54,"column":20},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":30}},{"name":"next","generated":{"line":54,"column":25},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":35}},{"generated":{"line":54,"column":29},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":30}},{"name":"y","generated":{"line":54,"column":30},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":40}},{"generated":{"line":54,"column":31},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":30}},{"generated":{"line":54,"column":32},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":43,"column":16}},{"generated":{"line":55,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":44,"column":16}},{"generated":{"line":56,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":45,"column":13}},{"generated":{"line":58,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":46,"column":12}},{"name":"tx","generated":{"line":58,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":46,"column":16}},{"generated":{"line":58,"column":12},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":46,"column":12}},{"generated":{"line":60,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":47,"column":12}},{"name":"transfer","generated":{"line":60,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":47,"column":16}},{"generated":{"line":60,"column":18},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":47,"column":12}},{"generated":{"line":60,"column":20},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":47,"column":26}},{"generated":{"line":61,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":16}},{"name":"ta","generated":{"line":61,"column":14},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":22}},{"generated":{"line":61,"column":16},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":24}},{"generated":{"line":61,"column":19},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":27}},{"name":"x","generated":{"line":61,"column":45},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":40}},{"generated":{"line":61,"column":46},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":27}},{"generated":{"line":61,"column":47},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":48,"column":16}},{"generated":{"line":63,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":16}},{"name":"ta","generated":{"line":63,"column":12},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":20}},{"generated":{"line":63,"column":14},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":22}},{"generated":{"line":63,"column":18},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":26}},{"name":"x","generated":{"line":63,"column":46},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":41}},{"generated":{"line":63,"column":47},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":26}},{"generated":{"line":63,"column":48},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":16}},{"generated":{"line":63,"column":50},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":49,"column":45}},{"name":"tx","generated":{"line":64,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":20}},{"name":"tx","generated":{"line":64,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":20}},{"generated":{"line":64,"column":12},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":22}},{"generated":{"line":64,"column":15},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":25}},{"name":"ta","generated":{"line":64,"column":16},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":26}},{"generated":{"line":64,"column":18},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":28}},{"name":"x","generated":{"line":64,"column":21},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":31}},{"generated":{"line":64,"column":22},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":32}},{"name":"buffer","generated":{"line":64,"column":23},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":33}},{"generated":{"line":64,"column":29},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":28}},{"name":"x","generated":{"line":64,"column":32},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":42}},{"generated":{"line":64,"column":33},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":25}},{"generated":{"line":64,"column":34},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":50,"column":20}},{"generated":{"line":65,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":51,"column":17}},{"generated":{"line":66,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":52,"column":13}},{"name":"_worker","generated":{"line":68,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":12}},{"name":"_worker","generated":{"line":68,"column":6},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":12}},{"generated":{"line":68,"column":13},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":19}},{"name":"postMessage","generated":{"line":68,"column":14},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":20}},{"generated":{"line":68,"column":25},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":12}},{"name":"x","generated":{"line":68,"column":26},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":32}},{"generated":{"line":68,"column":27},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":12}},{"name":"tx","generated":{"line":68,"column":29},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":35}},{"generated":{"line":68,"column":31},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":37}},{"generated":{"line":68,"column":35},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":41}},{"generated":{"line":68,"column":37},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":53,"column":12}},{"generated":{"line":69,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":54,"column":9}},{"generated":{"line":69,"column":5},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":40,"column":11}},{"name":"done","generated":{"line":71,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":55,"column":8}},{"name":"done","generated":{"line":71,"column":4},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":55,"column":8}},{"generated":{"line":71,"column":8},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":55,"column":12}},{"generated":{"line":71,"column":11},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":55,"column":15}},{"generated":{"line":72,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":56,"column":12}},{"name":"terminate","generated":{"line":72,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":56,"column":16}},{"generated":{"line":72,"column":19},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":56,"column":25}},{"generated":{"line":72,"column":22},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":56,"column":28}},{"generated":{"line":72,"column":23},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":56,"column":12}},{"generated":{"line":72,"column":25},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":56,"column":31}},{"name":"setTimeout","generated":{"line":73,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":16}},{"name":"setTimeout","generated":{"line":73,"column":8},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":16}},{"generated":{"line":73,"column":18},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":26}},{"generated":{"line":73,"column":19},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":27}},{"generated":{"line":73,"column":25},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":33}},{"name":"LOGGER","generated":{"line":74,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":58,"column":20}},{"name":"info","generated":{"line":74,"column":22},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":58,"column":27}},{"generated":{"line":74,"column":26},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":58,"column":20}},{"generated":{"line":74,"column":27},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":58,"column":32}},{"generated":{"line":74,"column":50},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":58,"column":20}},{"name":"_worker","generated":{"line":76,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":59,"column":20}},{"name":"_worker","generated":{"line":76,"column":10},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":59,"column":20}},{"generated":{"line":76,"column":17},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":59,"column":27}},{"name":"terminate","generated":{"line":76,"column":18},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":59,"column":28}},{"generated":{"line":76,"column":27},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":59,"column":20}},{"generated":{"line":77,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":60,"column":17}},{"generated":{"line":77,"column":9},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":26}},{"name":"terminate","generated":{"line":77,"column":11},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":60,"column":19}},{"generated":{"line":77,"column":20},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":26}},{"generated":{"line":77,"column":21},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":57,"column":16}},{"generated":{"line":78,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":61,"column":13}},{"generated":{"line":79,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":62,"column":9}},{"generated":{"line":81,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":40,"column":11}},{"generated":{"line":81,"column":3},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":40,"column":4}},{"generated":{"line":82,"column":0},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":64,"column":1}},{"generated":{"line":82,"column":1},"source":"../node_modules/@thi.ng/rstream/subs/post-worker.js","original":{"line":38,"column":7}}],"sources":{"../node_modules/@thi.ng/rstream/subs/post-worker.js":"import { isTransferable, isTypedArray } from \"@thi.ng/checks\";\nimport { LOGGER } from \"../api\";\nimport { makeWorker } from \"../utils/worker\";\n/**\n * Creates a {@link ISubscriber | subscriber} which forwards received\n * values to given worker.\n *\n * @remarks\n * The `worker` can be an existing `Worker` instance, a JS source code\n * `Blob` or an URL string. In the latter two cases, a worker is created\n * automatically. If `transfer` is true, the received values will be\n * marked as *transferrable* and the host app loses all access\n * permissions to these marked values. See `Worker.postMessage()` for\n * details.\n *\n * If `terminate` is set to a positive number, then the worker will be\n * automatically terminated after the stated number of milliseconds\n * since the parent subscription is {@link ISubscriber.done}.\n *\n * @example\n * ```ts\n * // worker source code\n * src = `self.onmessage = (e) => console.log(\"worker\", e.data);`;\n *\n * a = stream();\n * a.subscribe(\n *   postWorker(src, { type: \"application/javascript\" }))\n * );\n *\n * a.next(42)\n * // worker 42\n * ```\n *\n * @param worker -\n * @param transfer -\n * @param terminate - worker termination delay (ms)\n */\nexport const postWorker = (worker, transfer = false, terminate = 0) => {\n    const _worker = makeWorker(worker);\n    return {\n        next(x) {\n            if (x instanceof Promise) {\n                x.then((y) => this.next(y));\n                return;\n            }\n            let tx;\n            if (transfer) {\n                const ta = isTypedArray(x);\n                if (ta || isTransferable(x)) {\n                    tx = [ta ? x.buffer : x];\n                }\n            }\n            _worker.postMessage(x, tx || []);\n        },\n        done() {\n            if (terminate > 0) {\n                setTimeout(() => {\n                    LOGGER.info(\"terminating worker...\");\n                    _worker.terminate();\n                }, terminate);\n            }\n        },\n    };\n};\n"},"lineCount":null}},"error":null,"hash":"49cd66d2b1d669a462b80b8982b68610","cacheData":{"env":{}}}